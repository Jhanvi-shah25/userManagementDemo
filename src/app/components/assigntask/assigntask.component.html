
<app-header></app-header>

<!--accordian-->

<mat-accordion [multi]="true" cdkDropListGroup cdkDropList [cdkDropListData]="nestedArray" (cdkDropListDropped)="dropItem($event)">
  <div *cdkDragPlaceholder></div>
  
  <mat-expansion-panel cdkDrag [cdkDragData]="parent" class="expansion-bg mat-elevation-z0 cursor-move example-list"
    *ngFor="let parent of nestedArray; let i = index" #chapterExpansionPanel
    (mouseenter)="mouseEnterHandler($event, chapterExpansionPanel)" [id]="parent.id" cdkDropListSortingDisabled>
    <mat-expansion-panel-header class="cursor-move">
      <mat-panel-title>
        <span class="accordion-header-span cursor-pointer example-box">
          {{parent.title}}</span>
      </mat-panel-title>
    </mat-expansion-panel-header>
<!-- 
    see {{parent.child[0].taskName}}
    see1 {{parent.child[0].firstName}} -->
    <ng-container *ngIf="i==0">

        <div cdkDropList [cdkDropListData]="parent.child" [cdkDropListConnectedTo]="connectedTo" class="item-list"
        (cdkDropListDropped)="dropItem($event)">
          <div class="example-custom-placeholder" *cdkDragPlaceholder></div>
            <div [id]="child._id" class="item-box" class="sub-lesson cursor-move" *ngFor="let child of parent.child; let j = index" cdkDrag>
              <span  class="cursor-pointer">{{ child.taskName }}</span>
            </div>
      </div>

    </ng-container>

    <ng-container *ngIf="i==1">
        <!-- <div *ngFor="let child of parent.child" style="border: ridge;" [id]="child._id"> -->
          <mat-card  *ngFor="let child of parent.child" style="border: ridge;" cdkDropList [cdkDropListData]="child.child" dragAndDropManager (cdkDropListDropped)="dropItem($event)" [cdkDropListConnectedTo]="child._id">
            <mat-card-header>{{ child.firstName }}</mat-card-header>
              <mat-card-content *ngFor="let sub of child.child" id="sub._id" cdkDrag>
                {{sub.taskName}}{{sub._id}}
              </mat-card-content>
            </mat-card>
        <!-- </div> -->
    </ng-container>

    <!--new for index updation-->
<!-- 
    <mat-card *ngIf="i===1">
      <mat-card-content cdkDropList dragAndDropManagerRoot [cdkDropListData]="parent.child"
      (cdkDropListDropped)="dropItem($event)" *ngFor="let item of parent.child" [id]="item._id">
        <ng-container >
          inner start

          <mat-card cdkDrag style="border: ridge;height: 100px;" cdkDropList [cdkDropListData]="item.child" dragAndDropManager [id]="item._id"
              (cdkDropListDropped)="dropItem($event)">
              <mat-card-header>{{item.firstName}}</mat-card-header>
              <mat-card-content *ngFor="let sub of item.child">
                {{sub.taskName}}
            </mat-card-content>
          </mat-card>

          inner end
        </ng-container>
      </mat-card-content>
    </mat-card> -->










  </mat-expansion-panel>
</mat-accordion>

<br>
<button class="btn btn-success" (click)="assignTaskToUser()" style="margin-left: 140px;">Assign</button> &nbsp;
<button class="btn btn-danger" [routerLink]="['/taskDashboard']">Cancel</button>


<!-- https://stackblitz.com/edit/angular-cdk-nested-drag-drop-tree-structure-zrvnnj?file=src%2Fapp%2Fapp.component.ts -->